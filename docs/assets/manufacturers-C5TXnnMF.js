import{t as A,S as w,J as F,F as C,D as I,E as R,j as o,I as y,v as g,q as f,K as t,L as T,O as k,M as E,N as O,T as v,P as U,Q as N,R as z,U as L}from"./toast-DaPRlz4a.js";/* empty css               */let m=document.getElementById("manufacturersApp");const r={current:m},a=y.map(e=>e);let l="",u=null,i=!1,p=!1;const S=()=>{r.current&&(r.current.replaceChildren(),v(M,r.current))},P=()=>{const e=l.trim();e&&(a.push(e),l="",S())},j=e=>{a.splice(e,1),S()},q=async()=>{if(!i){t.error("Sign in to save changes.");return}try{await L(a.map(e=>e)),t.success("Manufacturers saved.")}catch(e){console.error("Failed to save manufacturers",e),t.error("Save failed. Try again.")}},b=()=>F().catch(e=>{console.error("Firebase sign-out failed",e),t.error("Sign out failed. Try again.")}),M=A(()=>[w(b),C.class`panel manufacturers-panel`(I("Manage Manufacturers"),R("Update the list used by the swatch editor and add new entries."),o.class`manufacturer-list`(...a.map((e,n)=>o.class`manufacturer-row`(g({class:"manufacturer-input",type:"text",value:()=>a[n]??"",onInput:s=>{a[n]=s.target.value}}),f({type:"button",class:"ghost-button",onClick:()=>j(n)},"Remove")))),o.class`manufacturer-add`(g({class:"manufacturer-input",type:"text",placeholder:"New manufacturer",value:()=>l,onInput:e=>{l=e.target.value}}),f({type:"button",class:"add-button",onClick:P},"âž• Add manufacturer")),o.class`auth-actions`(f({type:"button",class:"add-button",onClick:q},"ðŸ’¾ Save to Firestore")))]),h=()=>{if(!r.current||p)return;const e=z(r);e&&(e.replaceChildren(),v(M,e),p=!0,m=r.current)},c=(e,n,s="")=>{r.current&&(T({rootRef:r,status:e,userEmail:n,adminEmail:"",onSignIn:()=>k().catch(d=>{console.error("Firebase sign-in failed",d),t.error("Sign in failed. Try again.")}),onSignOut:b,setAppMounted:d=>{p=d}}),m=r.current)};c("loading","","initial");const x=async()=>{E().then(({redirectError:e})=>{e&&t.error("Sign-in failed after redirect. Try again.")}).catch(e=>{console.error("Failed to prepare auth",e),t.error("Sign-in setup failed. Try again.")}),O(async e=>{if(i=!1,!e){u&&(u(),u=null),c("login","","auth:logged-out");return}let n=!1;try{n=await U(e.email||"")}catch(s){console.error("Failed to load admin list",s),t.error("Unable to verify access. Check Firestore rules."),c("denied",e.email||"","auth:permissions");return}if(!n){u&&(u(),u=null),t.error(`Signed in as ${e.email||"unknown"} but not authorized.`),c("denied",e.email||"","auth:denied");return}i=!0,u||(u=N(s=>{Array.isArray(s)&&s.length?a.splice(0,a.length,...s):a.splice(0,a.length,...y),i&&h()})),h()})};x();
