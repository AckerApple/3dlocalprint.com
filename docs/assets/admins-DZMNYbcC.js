import"./version-BKoZn0Lf.js";import{t as S,w as C,j as U,g as R,p as E,d as l,i as g,c as m,x as F,y as r,z as I,A as L,B as M,P as O,D as h,C as T,Q as k}from"./auth-handler-CbhqdzIw.js";import{A as z}from"./AdminNav.tag-CZV5rcZC.js";import"./adminNavItems-u5BZOrdS.js";let p=document.getElementById("adminsApp");const o={current:p},t=[];let c="",s=null,u=!1,d=!1,v=null;const f=()=>{o.current&&(o.current.replaceChildren(),h(w,o.current))},B=()=>{const e=c.trim().toLowerCase();if(!e){r.error("Enter an email address.");return}if(t.some(a=>a.toLowerCase()===e)){r.error("That admin is already listed.");return}t.push(e),c="",f()},D=e=>{const a=t[e]||"";confirm(`Remove admin ${a}?`)&&(t.splice(e,1),f())},N=async()=>{if(!u){r.error("Sign in to save changes.");return}try{await k(t.map(e=>e)),r.success("Admins saved.")}catch(e){console.error("Failed to save admins",e),r.error("Save failed. Try again.")}},y=()=>C().catch(e=>{console.error("Firebase sign-out failed",e),r.error("Sign out failed. Try again.")}),w=S(()=>[z(y,v),U.class`panel manufacturers-panel`(R("Manage Admins"),E("Update the list of emails allowed to access the filament tools."),l.class`manufacturer-list`(...t.map((e,a)=>l.class`manufacturer-row`(g.class`manufacturer-input`.type`email`.value(i=>t[a]??"").onInput(i=>{t[a]=i.target.value.trim().toLowerCase()})(),m.type`button`.class`ghost-button`.onClick(()=>D(a))("Remove")))),l.class`manufacturer-add`(g.class`manufacturer-input`.type`email`.attr("placeholder","New admin email").value(e=>c).onInput(e=>{c=e.target.value})(),m.type`button`.class`add-button`.onClick(B)("âž• Add admin")),l.class`auth-actions`(m.type`button`.class`add-button`.onClick(N)("ðŸ’¾ Save to Firestore")))]),A=()=>{if(!o.current||d)return;const e=T(o);e&&(e.replaceChildren(),h(w,e),d=!0,p=o.current)},b=(e,a,i="")=>{I({rootRef:o,status:e,userEmail:a,adminEmail:"",onSignIn:()=>L().catch(n=>{console.error("Firebase sign-in failed",n),r.error("Sign in failed. Try again.")}),onSignOut:y,setAppMounted:n=>{d=n}}),p=o.current};b("loading","","initial");const P=async(e,a="")=>{u=!1,await M({user:e,mountSso:b,toast:r,setCurrentUser:n=>{v=n},onSignedOut:()=>{s&&(s(),s=null)},onDenied:()=>{s&&(s(),s=null)},onAuthorized:()=>{u=!0,s||(s=O(n=>{Array.isArray(n)&&n.length?t.splice(0,t.length,...n):t.splice(0,t.length),u&&(d?f():A())})),A()},reason:a})};F({onUser:P,toast:r});
